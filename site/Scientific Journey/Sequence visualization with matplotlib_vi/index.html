
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://lamdv.github.io/Scientific%20Journey/Sequence%20visualization%20with%20matplotlib_vi/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>Hi·ªÉn th·ªã d·ªØ li·ªáu chu·ªói v·ªõi matplotlib - Liam</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hien-thi-du-lieu-chuoi-voi-matplotlib" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Liam" class="md-header__button md-logo" aria-label="Liam" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Liam
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Hi·ªÉn th·ªã d·ªØ li·ªáu chu·ªói v·ªõi matplotlib
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/lamdv/lamdv.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Liam" class="md-nav__button md-logo" aria-label="Liam" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Liam
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/lamdv/lamdv.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../CV/" class="md-nav__link">
        Curriculum Vitae
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Scientific Journey
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Scientific Journey" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Scientific Journey
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xgboost_c%2Bt/" class="md-nav__link">
        XGBoost's objective function comparison
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Report/report/" class="md-nav__link">
        Viable method to combine C+T predictors for enhanced prediction power
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Scientific Journey/machine learning machine learning_en.md" class="md-nav__link">
        Model Selection: Machine learning Machine Learning - Part 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Scientific Journey/Sequence visualization with matplotlib.md" class="md-nav__link">
        Visualizing Sequence data with Matplotlib
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Scientific Journey/Sequence visualization with matplotlib_vi.md" class="md-nav__link">
        Hi·ªÉn th·ªã d·ªØ li·ªáu chu·ªói
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Thought
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Thought" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Thought
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Thought/the-death-of-expertise/" class="md-nav__link">
        The Death of Expertise
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Thought/on-writing/" class="md-nav__link">
        V·ªÅ chuy·ªán vi·∫øt l√°ch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-dirty-way-1" class="md-nav__link">
    The dirty way 1
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#y-tuong" class="md-nav__link">
    √ù t∆∞·ªüng
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yeu-cau" class="md-nav__link">
    Y√™u c·∫ßu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oc-oc-oc" class="md-nav__link">
    ƒê·ªçc ƒë·ªçc ƒë·ªçc...
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ok-en-oan-vui" class="md-nav__link">
    OK ƒë·∫øn ƒëo·∫°n vui
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/lamdv/lamdv.github.io/edit/source/docs/Scientific Journey/Sequence visualization with matplotlib_vi.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="hien-thi-du-lieu-chuoi-voi-matplotlib">Hi·ªÉn th·ªã d·ªØ li·ªáu chu·ªói v·ªõi matplotlib</h1>
<h5 id="the-dirty-way-1"><em>The dirty way</em> <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></h5>
<p>C√≥ l·∫Ω ƒë√£ c√≥ r·∫•t nhi·ªÅu package Python cho ph√©p hi·ªÉn th·ªã d·ªØ li·ªáu Multiple Sequence Alignment (MSA). Tuy v·∫≠y, th·ªùi gian c·ªßa k·ªπ s∆∞ ph·∫ßn m·ªÅm v√† nh√† nghi√™n c·ª©u tin sinh h·ªçc c√≥ l·∫Ω n√™n d√†nh ƒë·ªÉ suy nghƒ© v·ªÅ thu·∫≠t to√°n v√† ph√°t tri·ªÉn ph·∫ßn m·ªÅm ri√™ng h∆°n l√† ng·ªìi h·ªçc th√™m m·ªôt v√†i package m·ªõi. ƒê√¥i khi kh√°c th√¨ c√°c package ch∆∞a ch·∫Øc ƒë√£ hi·ªÉn th·ªã ƒë√∫ng metrics v√† ƒë·ªãnh d·∫°ng m√† ta mong mu·ªën. Trong notebook n√†y m√¨nh s·∫Ω th·ª≠ hi·ªÉn th·ªã m·ªôt dataset MSA ng·∫Øn (75 residues) v√† m·ªôt bi·ªÉu ƒë·ªì c·ªôt cho th·∫•y t√≠nh b·∫£o to√†n c·ªßa t·ª´ng residue s·ª≠ d·ª•ng matplotlib. Ph√©p t√≠nh ƒë·ªô b·∫£o to√†n n√†y kh√¥ng ƒë√∫ng l·∫Øm, nh∆∞ng ƒëi·ªÅu ƒë√≥ kh√¥ng qu√° quan tr·ªçng. Cu·ªëi c√πng ch√∫ng ta c≈©ng hi·ªÉn th·ªã m·ªôt chu·ªói ƒë·ªìng thu·∫≠n, chu·ªói n√†y l√† t·ª´ng amino acid c√≥ t·ªâ l·ªá cao nh·∫•t ·ªü m·ªói residue - m·ªôt l·∫ßn n·ªØa, ƒëi·ªÅu n√†y c√≥ th·ªÉ kh√¥ng ch√≠nh x√°c v·ªÅ m·∫∑t sinh h·ªçc, nh∆∞ng c√°c b·∫°n c√≥ th·ªÉ thay ƒë·ªïi ƒë·ªÉ cho ph√π h·ª£p h∆°n v·ªõi d·ªØ li·ªáu v√† th·ªëng k√™ c·ªßa ri√™ng m√¨nh.</p>
<h2 id="y-tuong">√ù t∆∞·ªüng</h2>
<p>√ù t∆∞·ªüng ƒë·∫±ng sau bi·ªÉu ƒë·ªì n√†y l√† d·ª±a v√†o bi·ªÉu ƒë·ªì th·ªëng k√™ ch√≠nh, ch√∫ng ta l·∫ßn l∆∞·ª£t ƒë·∫∑t t·ª´ng residue v√†o v·ªã tr√≠ c·ªßa n√≥ d∆∞·ªõi c√°c c·ªôt bi·ªÉu ƒë·ªì. B·ªüi v√¨ matplotlib x√°c ƒë·ªãnh v·ªã tr√≠ c√°c ƒë·ªëi t∆∞·ª£ng trong bi·ªÉu ƒë·ªì c·ªßa m√¨nh qua "data space" hay c√°c m·ªëc v·ªã tr√≠ d·ª±a tr√™n d·ªØ li·ªáu, ch√∫ng ta c√≥ th·ªÉ "hack" n√≥ ƒë·ªÉ gi√≥ng h√†ng c√°c residue c·ªßa m√¨nh. ƒê∆°n gi·∫£n v·∫ßy thui.</p>
<h2 id="yeu-cau">Y√™u c·∫ßu</h2>
<ol>
<li>Th∆∞ vi·ªán</li>
</ol>
<p>Ta c·∫ßn c√°c th∆∞ vi·ªán sau: matplotlib (duh), BioPython v√† NumPy. BioPython d√πng ƒë·ªÉ qu·∫£n l√Ω, ƒë·ªçc v√† ghi c√°c MSA, d√π ta c≈©ng c√≥ th·ªÉ t·ª± vi·∫øt parser v√† ƒë·ªçc file FASTA tr·ª±c ti·∫øp - nh∆∞ng m√† l∆∞·ªùi :D. NumPy d√πng ƒë·ªÉ t√≠nh to√°n v√† t∆∞∆°ng t√°c v·ªõi matplotlib, ngo√†i ra th·ªùi n√†y ai m√† ch·∫≥ng d√πng numpy khi vi·∫øt tutorial tr√™n m·∫°ng c∆° ch·ª©...</p>
<pre><code class="language-python">import numpy as np, Bio, matplotlib.pyplot as plot
from matplotlib.ticker import FormatStrFormatter
from Bio import SeqIO

%matplotlib inline
</code></pre>
<ol>
<li>ƒê·ªÉ v·∫Ω m·ªôt c√°ch ch√≠nh x√°c, tr∆∞·ªõc h·∫øt ta c·∫ßn ƒë·ªãnh nghƒ©a v√†i th·ª©. Tr∆∞·ªõc ti√™n, ch√∫ng ta c·∫ßn m·ªôt h·ªç font monospace ƒë·ªÉ ƒë·∫£m b·∫£o c√°c residue s·∫Ω ƒë∆∞·ª£c th·∫≥ng h√†ng. Monospace font c√≥ kho·∫£ng c√°ch b·∫±ng nhau b·∫•t k·ªÉ k√Ω t·ª± - ch·ªØ A v√† ch·ªØ I ƒë·ªÅu t·ªën di·ªán t√≠ch nh∆∞ nhau. D·ªÖ hi·ªÉu t·∫°i sao ch√∫ng ta c·∫ßn font n√†y ph·∫£i kh√¥ng.</li>
</ol>
<pre><code class="language-python">font = {'family': 'monospace',
        'color':  'darkred',
        'weight': 'normal',
        'size': 16,
        }
</code></pre>
<p>Ti·∫øp theo ch√∫ng ta c·∫ßn m·ªôt c√°i b·∫£ng m√†u. C√≥ 20 amino acid, v√† c·∫ßn th√™m 1 m√†u ƒë·ªÉ hi·ªÉn th·ªã gap. B·∫£ng m√†u m√¨nh s·ª≠ d·ª•ng ·ªü ƒë√¢y c≈©ng l√† b·∫£ng m√†u ƒë∆∞·ª£c RasMol s·ª≠ d·ª•ng (c√°i ph·∫ßn m·ªÅm n√†y x∆∞a nh∆∞ tr√°i ƒë·∫•t r·ªìi holy f)</p>
<pre><code class="language-python">palette = [
    '#C8C8C8', '#145AFF', '#00DCDC', '#E60A0A', '#E6E600',
    '#00DCDC', '#E60A0A', '#EBEBEB', '#8282D2', '#0F820F', 
    '#0F820F', '#145AFF', '#E6E600', '#3232AA', '#DC9682', 
    '#FA9600', '#FA9600', '#B45AB4', '#3232AA', '#0F820F', 
    '#FFFFFF']
</code></pre>
<p>Cu·ªëi c√πng ta c√≥ m·ªôt string ch·ª©a t·∫•t c·∫£ c√°c amino acid c√≥ th·ªÉ nh·∫≠n, v√† kho·∫£ng tr·ªëng</p>
<pre><code class="language-python">aa = 'ARNDCQEGHILKMFPSTWYV-'
</code></pre>
<h2 id="oc-oc-oc">ƒê·ªçc ƒë·ªçc ƒë·ªçc...</h2>
<p>Vi·ªác ƒë·∫ßu ti√™n, ƒë∆∞∆°ng nhi√™n l√† ƒë·ªçc c·∫£ chu·ªói MSA v√† t√≠nh to√°n m·ªôt s·ªë th√¥ng s·ªë c∆° b·∫£n: Chi·ªÅu d√†i chu·ªói L v√† s·ªë chu·ªói N.</p>
<pre><code class="language-python">fasta_file = 'src/Inputs/example/1atzA.fas'
msa = list(SeqIO.parse(fasta_file,'fasta'))
L = len(msa[0].seq)
N = len(msa)
</code></pre>
<p>T√≠nh to√°n t·∫ßn su·∫•t t·ª´ng amino acid ·ªü m·ªói residue, v√† nh√¢n ti·ªán t√≠nh lu√¥n chu·ªói ƒë·ªìng thu·∫≠n.</p>
<pre><code class="language-python">freq = np.zeros([L,21])
concensus = np.zeros(L)
for i in range(0,N):
    for j in range(0,L):
        j_aa = aa.find(msa[i].seq[j])
        freq[j,j_aa] = freq[j,j_aa] + 1
for i in range(0, L):
    concensus[i] = freq[i].argmax()
</code></pre>
<p>Ch·∫Øc ƒëo·∫°n n√†y d·ªÖ ha. </p>
<p>ƒê·ªÉ t√≠nh to√°n ƒë·ªô b·∫£o to√†n, ch√∫ng ta d√πng c√¥ng th·ª©c nh∆∞ sau:</p>
<p>
<script type="math/tex; mode=display">
C_i = \sqrt{\sum_{j}^{j=21}{(\frac{f_j}{N} - 0.05)^2}}
</script>
</p>
<p>v·ªõi <script type="math/tex">C_i</script> l√† ƒë·ªô b·∫£o to√†n c·ªßa residue th·ª© <script type="math/tex">i</script>.</p>
<p>T·∫°i sao l·∫°i l√† 0.05? B·ªüi v√¨ n√≥ l√† <script type="math/tex">1/20</script>, v√† ·ªü th√¨ c√≥ 20 amino acid. Kho·∫£ng tr·ªëng kh√¥ng t√≠nh...
<em>(t·∫•t nhi√™n l√† c√≥ 21 gi√° tr·ªã c√≥ th·ªÉ nh·∫≠n ƒë∆∞·ª£c nh∆∞ng m√† c√°i note n√†y ƒë·ªß b·∫≠y r·ªìi lmao)</em></p>
<pre><code class="language-python">conservation = np.sqrt(np.sum((np.square(freq/N - 0.05)),axis=1))
</code></pre>
<h2 id="ok-en-oan-vui">OK ƒë·∫øn ƒëo·∫°n vui</h2>
<p>B·ªüi v√¨ kh√¥ng c√≥ c√°ch n√†o c√≥ s·∫µn ƒë·ªÉ v·∫Ω c·∫£ m·ªõ chu·ªói n√†y v√†o ƒë·ªì th·ªã, ch·ªó code d∆∞·ªõi n√†y nh√¨n s·∫Ω kh√° r·ªëi r·∫Øm. ƒê·ªìng th·ªùi n√≥ c≈©ng ch∆∞a ch·∫Øc l√† c√°ch ngon nh·∫•t ƒë·ªÉ l√†m (ch·∫Øc kh√¥ng ph·∫£i ƒë√¢u)... nh∆∞ng n√≥ l√† m·ªôt c√°ch</p>
<!-- *Notes: I put *````figure````* in places where I want to draw the figure **for demonstration purpose**. You may want to remove them when you recombine the code boxes in your notebook, otherwise it will draw multiple graph. On itself.* -->

<p>Tr∆∞·ªõc ti√™n, t·∫•t nhi√™n ta t·∫°o m·ªôt ƒë·ªì th·ªã v√† c√°c tr·ª•c t∆∞∆°ng ·ª©ng. C√°i ƒë·ªì th·ªã n√†y ƒë∆∞·ª£c thi·∫øt l·∫≠p kh√° r·ªông, v√¨ c√°i chu·ªói nh√©t v√†o n√≥ d√†ii <em>wink wink</em>.</p>
<pre><code class="language-python">figure = plot.figure(figsize=(20,2))
axes = plot.axes([0,0,1,1]);
plot.close()
</code></pre>
<p>OK gi·ªù ƒë·∫øn l√∫c v·∫Ω c√°i ƒë·ªì th·ªã v·ªÅ ƒë·ªô b·∫£o to√†n. n√≥ ƒë∆°n gi·∫£n ch·ªâ l√† m·ªôt c√°i bar graph cho th·∫•y ƒë·ªô b·∫£o to√†n ·ªü t·ª´ng residue.</p>
<p>Reminder: ƒë·ªÉ g·ªçi bargraph: <code>axes.bar(range,data,**args)</code>. Trong tr∆∞·ªùng h·ª£p n√†y ch√∫ng ta c·∫ßn c√°c parameters <code>align='edge', linewidth=0</code> ƒë·ªÉ gi√≥ng h√†ng c√°c amino acid. <code>align='edge'</code> l√†m cho c√°c c·ªôt gi√≥ng h√†ng ·ªü c·∫°nh tr√°i, v√† <code>linewidth=0</code> l√†m cho kho·∫£ng c√°ch c√°c c·ªôt kh√≠t h∆°n.</p>
<pre><code class="language-python">axes.bar(range(0,L),conservation, align='edge', linewidth = 0, color = 'red')
axes.set_ylabel('Conservation')
</code></pre>
<p><img alt="svg" src="../Sequence%20visualization%20with%20matplotlib_files/Sequence%20visualization%20with%20matplotlib_21_0.svg" /></p>
<p>Gi·ªù ƒë·∫øn l√∫c v·∫Ω c√°c chu·ªói. Ch√∫ng ta l·∫•y ra 5 chu·ªói ng·∫´u nhi√™n t·ª´ MSA, ƒë∆°n gi·∫£n v√¨ v·ªõi 1000 chu·ªói th√¨ data c·ªßa m√¨nh qu√° r·ªông ƒë·ªÉ c√≥ th·ªÉ v·∫Ω t·∫•t c·∫£. ƒê·ªìng th·ªùi ch√∫ng ta t√≠nh to√°n kho·∫£ng c√°ch gi·ªØa c√°c chu·ªói, c≈©ng nh∆∞ kho·∫£ng c√°ch t·ª´ ƒë√°y ƒë·ªì th·ªã ƒë·∫øn chu·ªói ƒë·∫ßu ti√™n.</p>
<p>Kho·∫£ng c√°ch gi·ªØa c√°c chu·ªói ƒë∆∞·ª£c t√≠nh b·∫±ng c·∫≠n c·ªßa tr·ª•c y chia 6. T·∫°i sao? V√¨ chia 6 n√≥ kh·ªõp h√†ng üòÖ, kh√¥ng c√≥ gi·∫£i th√≠ch n√†o hay h∆°n c·∫£ ...</p>
<pre><code class="language-python">spacing_scale = axes.get_ylim()[1]/6
spacing = spacing_scale*2

seq_display = np.sort(np.random.randint(0,N,[5]))
</code></pre>
<p>Ok, gi·ªù th√¨ l√†m sao m√† v·∫Ω?</p>
<p>V·ªõi m·ªói chu·ªói, tr∆∞·ªõc ti√™n ta t√≠nh to√°n kho·∫£ng c√°ch ƒë·∫øn g·ªëc t·ªça ƒë·ªô <script type="math/tex">(0, 0)</script>. V·ªã tr√≠ tr·ª•c x c·ªßa t·ª´ng residue ƒë∆∞·ª£c t√≠nh to√°n ƒë∆°n gi·∫£n l√† v·ªã tr√≠ c·ªßa ch√≠nh n√≥ trong chu·ªói. Kh√° g·ªçn. Ti√™u ƒë·ªÅ c·ªßa t·ª´ng chu·ªói ƒë∆∞·ª£c v·∫Ω d·ªãch v·ªÅ b√™n tr√°i b·∫±ng c√°ch l·∫•y gi√° tr·ªã x √¢m, v√† trong tr∆∞·ªùng h·ª£p n√†y ta l·∫•y l√† -5.</p>
<p><code>axes.text()</code> ƒë∆∞·ª£c g·ªçi ƒë·ªÉ v·∫Ω t·ª´ng residue. V·ªõi m·ªói residue ch√∫ng ta c√≥ m·ªôt c√°i bbox v·∫Ω ƒë√® l√™n. C√°c bbox n√†y c√≥ <code>alpha=0.5</code> ƒë·ªÉ n√≥  trong su·ªët, v√† m√†u nh∆∞ trong palette m√†u ƒë√£ ƒë·ªãnh nghƒ©a ·ªü tr√™n.</p>
<p>√Ä m√† nh·ªõ d√πng <code>fontdict=font</code> ƒë·ªÉ x√†i c√°i font family n√£y nh√©.</p>
<pre><code class="language-python">for j in seq_display:
    posit = -float(np.where(seq_display == j)[0]) * spacing_scale - spacing
    axes.text(-5,posit, &quot;Seq &quot;+(str(j+1)))
    for i in range(0, L):
        axes.text(float(i),posit, msa[j].seq[i],
            bbox=dict(facecolor=palette[aa.find(msa[j].seq[i])], 
            alpha=0.5),fontdict=font)
</code></pre>
<p><img alt="svg" src="../Sequence%20visualization%20with%20matplotlib_files/Sequence%20visualization%20with%20matplotlib_25_0.svg" /></p>
<p>Cu·ªëi c√πng, ch√∫ng ta th√™m chu·ªói ƒë·ªìng thu·∫≠n:</p>
<pre><code class="language-python">posit = posit - spacing
axes.text(-5,posit, &quot;Concensus&quot;)
for i in range(0, L):
    axes.text(float(i),posit, 'ARNDCQEGHILKMFPSTWYV-'[int(concensus[i])] ,
                bbox=dict(facecolor=palette[int(concensus[i])], 
                alpha=0.5),fontdict=font)
</code></pre>
<p><img alt="svg" src="../Sequence%20visualization%20with%20matplotlib_files/Sequence%20visualization%20with%20matplotlib_27_0.svg" /></p>
<p>Et voila! ƒê√¢y l√† m·ªôt c√°ch nhanh (v√† b·∫©n) ƒë·ªÉ hi·ªÉn th·ªã dataset. M√¨nh hi v·ªçng n√≥ ƒë·ªß ƒë∆°n gi·∫£n ƒë·ªÉ c√°c b·∫°n c√≥ th·ªÉ t·ª± bi·ªÉn ƒë·ªïi n√≥ cho t·ª´ng lo·∫°i d·ªØ li·ªáu ri√™ng (Genomics, transcriptomics...), v√† c≈©ng nh∆∞ d√πng c√°c lo·∫°i ƒë·ªì th·ªã kh√°c l√†m n·ªÅn t·∫£ng. Tuy nhi√™n, ph∆∞∆°ng ph√°p n√†y c√≥ l·∫Ω kh√¥ng ph·∫£i l√† c√°ch t·ªët nh·∫•t ƒë·ªÉ hi·ªÉn th·ªã c√°c chu·ªói d√†i h∆°n - b·∫°n ph·∫£i t·ª± t√¨m ƒë∆∞·ªùng ph√π h·ª£p nh·∫•t v·ªõi d·ªØ li·ªáu c·ªßa m√¨nh. Nh∆∞ng ƒë√≥ l√† ƒëi·ªÅu hay ho khi l√†m Bioinfomatics!!! V√† gi·ªù th√¨ b·∫°n c√≥ to√†n quy·ªÅn ki·ªÉm so√°t tr√™n qu√° tr√¨nh r·ªìi.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Notebook Jupyter g·ªëc (ti·∫øng Anh) th√¨ ·ªü <a href="https://github.com/lamdv/lamdv.github.io/blob/source/docs/Sequence%20visualization%20with%20matplotlib.ipynb">ƒë√¢y</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.b1047164.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>