<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Hi&#x1EC3;n th&#x1ECB; d&#x1EEF; li&#x1EC7;u chu&#x1ED7;i v&#x1EDB;i matplotlib</title>
        <style>
</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-body">
        <h1 id="hiá»ƒn-thá»‹-dá»¯-liá»‡u-chuá»—i-vá»›i-matplotlib">Hiá»ƒn thá»‹ dá»¯ liá»‡u chuá»—i vá»›i matplotlib</h1>
<h5 id="the-dirty-way-1"><em>The dirty way</em> [^1]</h5>
<p>CÃ³ láº½ Ä‘Ã£ cÃ³ ráº¥t nhiá»u package Python cho phÃ©p hiá»ƒn thá»‹ dá»¯ liá»‡u Multiple Sequence Alignment (MSA). Tuy váº­y, thá»i gian cá»§a ká»¹ sÆ° pháº§n má»m vÃ  nhÃ  nghiÃªn cá»©u tin sinh há»c cÃ³ láº½ nÃªn dÃ nh Ä‘á»ƒ suy nghÄ© vá» thuáº­t toÃ¡n vÃ  phÃ¡t triá»ƒn pháº§n má»m riÃªng hÆ¡n lÃ  ngá»“i há»c thÃªm má»™t vÃ i package má»›i. ÄÃ´i khi khÃ¡c thÃ¬ cÃ¡c package chÆ°a cháº¯c Ä‘Ã£ hiá»ƒn thá»‹ Ä‘Ãºng metrics vÃ  Ä‘á»‹nh dáº¡ng mÃ  ta mong muá»‘n. Trong notebook nÃ y mÃ¬nh sáº½ thá»­ hiá»ƒn thá»‹ má»™t dataset MSA ngáº¯n (75 residues) vÃ  má»™t biá»ƒu Ä‘á»“ cá»™t cho tháº¥y tÃ­nh báº£o toÃ n cá»§a tá»«ng residue sá»­ dá»¥ng matplotlib. PhÃ©p tÃ­nh Ä‘á»™ báº£o toÃ n nÃ y khÃ´ng Ä‘Ãºng láº¯m, nhÆ°ng Ä‘iá»u Ä‘Ã³ khÃ´ng quÃ¡ quan trá»ng. Cuá»‘i cÃ¹ng chÃºng ta cÅ©ng hiá»ƒn thá»‹ má»™t chuá»—i Ä‘á»“ng thuáº­n, chuá»—i nÃ y lÃ  tá»«ng amino acid cÃ³ tá»‰ lá»‡ cao nháº¥t á»Ÿ má»—i residue - má»™t láº§n ná»¯a, Ä‘iá»u nÃ y cÃ³ thá»ƒ khÃ´ng chÃ­nh xÃ¡c vá» máº·t sinh há»c, nhÆ°ng cÃ¡c báº¡n cÃ³ thá»ƒ thay Ä‘á»•i Ä‘á»ƒ cho phÃ¹ há»£p hÆ¡n vá»›i dá»¯ liá»‡u vÃ  thá»‘ng kÃª cá»§a riÃªng mÃ¬nh.</p>
<h2 id="Ã½-tÆ°á»Ÿng">Ã tÆ°á»Ÿng</h2>
<p>Ã tÆ°á»Ÿng Ä‘áº±ng sau biá»ƒu Ä‘á»“ nÃ y lÃ  dá»±a vÃ o biá»ƒu Ä‘á»“ thá»‘ng kÃª chÃ­nh, chÃºng ta láº§n lÆ°á»£t Ä‘áº·t tá»«ng residue vÃ o vá»‹ trÃ­ cá»§a nÃ³ dÆ°á»›i cÃ¡c cá»™t biá»ƒu Ä‘á»“. Bá»Ÿi vÃ¬ matplotlib xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cÃ¡c Ä‘á»‘i tÆ°á»£ng trong biá»ƒu Ä‘á»“ cá»§a mÃ¬nh qua &quot;data space&quot; hay cÃ¡c má»‘c vá»‹ trÃ­ dá»±a trÃªn dá»¯ liá»‡u, chÃºng ta cÃ³ thá»ƒ &quot;hack&quot; nÃ³ Ä‘á»ƒ giÃ³ng hÃ ng cÃ¡c residue cá»§a mÃ¬nh. ÄÆ¡n giáº£n váº§y thui.</p>
<h2 id="yÃªu-cáº§u">YÃªu cáº§u</h2>
<ol>
<li>ThÆ° viá»‡n</li>
</ol>
<p>Ta cáº§n cÃ¡c thÆ° viá»‡n sau: matplotlib (duh), BioPython vÃ  NumPy. BioPython dÃ¹ng Ä‘á»ƒ quáº£n lÃ½, Ä‘á»c vÃ  ghi cÃ¡c MSA, dÃ¹ ta cÅ©ng cÃ³ thá»ƒ tá»± viáº¿t parser vÃ  Ä‘á»c file FASTA trá»±c tiáº¿p - nhÆ°ng mÃ  lÆ°á»i :D. NumPy dÃ¹ng Ä‘á»ƒ tÃ­nh toÃ¡n vÃ  tÆ°Æ¡ng tÃ¡c vá»›i matplotlib, ngoÃ i ra thá»i nÃ y ai mÃ  cháº³ng dÃ¹ng numpy khi viáº¿t tutorial trÃªn máº¡ng cÆ¡ chá»©...</p>
<pre><code class="language-python"><div><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np, Bio, matplotlib.pyplot <span class="hljs-keyword">as</span> plot
<span class="hljs-keyword">from</span> matplotlib.ticker <span class="hljs-keyword">import</span> FormatStrFormatter
<span class="hljs-keyword">from</span> Bio <span class="hljs-keyword">import</span> SeqIO

%matplotlib inline
</div></code></pre>
<ol>
<li>Äá»ƒ váº½ má»™t cÃ¡ch chÃ­nh xÃ¡c, trÆ°á»›c háº¿t ta cáº§n Ä‘á»‹nh nghÄ©a vÃ i thá»©. TrÆ°á»›c tiÃªn, chÃºng ta cáº§n má»™t há» font monospace Ä‘á»ƒ Ä‘áº£m báº£o cÃ¡c residue sáº½ Ä‘Æ°á»£c tháº³ng hÃ ng. Monospace font cÃ³ khoáº£ng cÃ¡ch báº±ng nhau báº¥t ká»ƒ kÃ½ tá»± - chá»¯ A vÃ  chá»¯ I Ä‘á»u tá»‘n diá»‡n tÃ­ch nhÆ° nhau. Dá»… hiá»ƒu táº¡i sao chÃºng ta cáº§n font nÃ y pháº£i khÃ´ng.</li>
</ol>
<pre><code class="language-python"><div>font = {<span class="hljs-string">&#x27;family&#x27;</span>: <span class="hljs-string">&#x27;monospace&#x27;</span>,
        <span class="hljs-string">&#x27;color&#x27;</span>:  <span class="hljs-string">&#x27;darkred&#x27;</span>,
        <span class="hljs-string">&#x27;weight&#x27;</span>: <span class="hljs-string">&#x27;normal&#x27;</span>,
        <span class="hljs-string">&#x27;size&#x27;</span>: <span class="hljs-number">16</span>,
        }
</div></code></pre>
<p>Tiáº¿p theo chÃºng ta cáº§n má»™t cÃ¡i báº£ng mÃ u. CÃ³ 20 amino acid, vÃ  cáº§n thÃªm 1 mÃ u Ä‘á»ƒ hiá»ƒn thá»‹ gap. Báº£ng mÃ u mÃ¬nh sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y cÅ©ng lÃ  báº£ng mÃ u Ä‘Æ°á»£c RasMol sá»­ dá»¥ng (cÃ¡i pháº§n má»m nÃ y xÆ°a nhÆ° trÃ¡i Ä‘áº¥t rá»“i holy f)</p>
<pre><code class="language-python"><div>palette = [
    <span class="hljs-string">&#x27;#C8C8C8&#x27;</span>, <span class="hljs-string">&#x27;#145AFF&#x27;</span>, <span class="hljs-string">&#x27;#00DCDC&#x27;</span>, <span class="hljs-string">&#x27;#E60A0A&#x27;</span>, <span class="hljs-string">&#x27;#E6E600&#x27;</span>,
    <span class="hljs-string">&#x27;#00DCDC&#x27;</span>, <span class="hljs-string">&#x27;#E60A0A&#x27;</span>, <span class="hljs-string">&#x27;#EBEBEB&#x27;</span>, <span class="hljs-string">&#x27;#8282D2&#x27;</span>, <span class="hljs-string">&#x27;#0F820F&#x27;</span>, 
    <span class="hljs-string">&#x27;#0F820F&#x27;</span>, <span class="hljs-string">&#x27;#145AFF&#x27;</span>, <span class="hljs-string">&#x27;#E6E600&#x27;</span>, <span class="hljs-string">&#x27;#3232AA&#x27;</span>, <span class="hljs-string">&#x27;#DC9682&#x27;</span>, 
    <span class="hljs-string">&#x27;#FA9600&#x27;</span>, <span class="hljs-string">&#x27;#FA9600&#x27;</span>, <span class="hljs-string">&#x27;#B45AB4&#x27;</span>, <span class="hljs-string">&#x27;#3232AA&#x27;</span>, <span class="hljs-string">&#x27;#0F820F&#x27;</span>, 
    <span class="hljs-string">&#x27;#FFFFFF&#x27;</span>]
</div></code></pre>
<p>Cuá»‘i cÃ¹ng ta cÃ³ má»™t string chá»©a táº¥t cáº£ cÃ¡c amino acid cÃ³ thá»ƒ nháº­n, vÃ  khoáº£ng trá»‘ng</p>
<pre><code class="language-python"><div>aa = <span class="hljs-string">&#x27;ARNDCQEGHILKMFPSTWYV-&#x27;</span>
</div></code></pre>
<h2 id="Ä‘á»c-Ä‘á»c-Ä‘á»c">Äá»c Ä‘á»c Ä‘á»c...</h2>
<p>Viá»‡c Ä‘áº§u tiÃªn, Ä‘Æ°Æ¡ng nhiÃªn lÃ  Ä‘á»c cáº£ chuá»—i MSA vÃ  tÃ­nh toÃ¡n má»™t sá»‘ thÃ´ng sá»‘ cÆ¡ báº£n: Chiá»u dÃ i chuá»—i L vÃ  sá»‘ chuá»—i N.</p>
<pre><code class="language-python"><div>fasta_file = <span class="hljs-string">&#x27;src/Inputs/example/1atzA.fas&#x27;</span>
msa = list(SeqIO.parse(fasta_file,<span class="hljs-string">&#x27;fasta&#x27;</span>))
L = len(msa[<span class="hljs-number">0</span>].seq)
N = len(msa)
</div></code></pre>
<p>TÃ­nh toÃ¡n táº§n suáº¥t tá»«ng amino acid á»Ÿ má»—i residue, vÃ  nhÃ¢n tiá»‡n tÃ­nh luÃ´n chuá»—i Ä‘á»“ng thuáº­n.</p>
<pre><code class="language-python"><div>freq = np.zeros([L,<span class="hljs-number">21</span>])
concensus = np.zeros(L)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,N):
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,L):
        j_aa = aa.find(msa[i].seq[j])
        freq[j,j_aa] = freq[j,j_aa] + <span class="hljs-number">1</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, L):
    concensus[i] = freq[i].argmax()
</div></code></pre>
<p>Cháº¯c Ä‘oáº¡n nÃ y dá»… ha.</p>
<p>Äá»ƒ tÃ­nh toÃ¡n Ä‘á»™ báº£o toÃ n, chÃºng ta dÃ¹ng cÃ´ng thá»©c nhÆ° sau:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msqrt><mrow><munderover><mo>âˆ‘</mo><mi>j</mi><mrow><mi>j</mi><mo>=</mo><mn>21</mn></mrow></munderover><mrow><mo stretchy="false">(</mo><mfrac><msub><mi>f</mi><mi>j</mi></msub><mi>N</mi></mfrac><mo>âˆ’</mo><mn>0.05</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mrow></msqrt></mrow><annotation encoding="application/x-tex">C_i = \sqrt{\sum_{j}^{j=21}{(\frac{f_j}{N} - 0.05)^2}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.500304em;vertical-align:-1.4137769999999998em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0865270000000002em;"><span class="svg-align" style="top:-5.460304000000001em;"><span class="pstrut" style="height:5.460304000000001em;"></span><span class="mord" style="padding-left:1.056em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8587770000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.347113em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-4.046527000000001em;"><span class="pstrut" style="height:5.460304000000001em;"></span><span class="hide-tail" style="min-width:0.742em;height:3.5403040000000003em;"><svg width='400em' height='3.5403040000000003em' viewBox='0 0 400000 3540' preserveAspectRatio='xMinYMin slice'><path d='M702 80H40000040
H742v3406l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 80H400000v40H742z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>vá»›i <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> lÃ  Ä‘á»™ báº£o toÃ n cá»§a residue thá»© <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>.</p>
<p>Táº¡i sao láº¡i lÃ  0.05? Bá»Ÿi vÃ¬ nÃ³ lÃ  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>20</mn></mrow><annotation encoding="application/x-tex">1/20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">2</span><span class="mord">0</span></span></span></span>, vÃ  á»Ÿ thÃ¬ cÃ³ 20 amino acid. Khoáº£ng trá»‘ng khÃ´ng tÃ­nh...
<em>(táº¥t nhiÃªn lÃ  cÃ³ 21 giÃ¡ trá»‹ cÃ³ thá»ƒ nháº­n Ä‘Æ°á»£c nhÆ°ng mÃ  cÃ¡i note nÃ y Ä‘á»§ báº­y rá»“i lmao)</em></p>
<pre><code class="language-python"><div>conservation = np.sqrt(np.sum((np.square(freq/N - <span class="hljs-number">0.05</span>)),axis=<span class="hljs-number">1</span>))
</div></code></pre>
<h2 id="ok-Ä‘áº¿n-Ä‘oáº¡n-vui">OK Ä‘áº¿n Ä‘oáº¡n vui</h2>
<p>Bá»Ÿi vÃ¬ khÃ´ng cÃ³ cÃ¡ch nÃ o cÃ³ sáºµn Ä‘á»ƒ váº½ cáº£ má»› chuá»—i nÃ y vÃ o Ä‘á»“ thá»‹, chá»— code dÆ°á»›i nÃ y nhÃ¬n sáº½ khÃ¡ rá»‘i ráº¯m. Äá»“ng thá»i nÃ³ cÅ©ng chÆ°a cháº¯c lÃ  cÃ¡ch ngon nháº¥t Ä‘á»ƒ lÃ m (cháº¯c khÃ´ng pháº£i Ä‘Ã¢u)... nhÆ°ng nÃ³ lÃ  má»™t cÃ¡ch</p>
<!-- *Notes: I put *````figure````* in places where I want to draw the figure **for demonstration purpose**. You may want to remove them when you recombine the code boxes in your notebook, otherwise it will draw multiple graph. On itself.* -->
<p>TrÆ°á»›c tiÃªn, táº¥t nhiÃªn ta táº¡o má»™t Ä‘á»“ thá»‹ vÃ  cÃ¡c trá»¥c tÆ°Æ¡ng á»©ng. CÃ¡i Ä‘á»“ thá»‹ nÃ y Ä‘Æ°á»£c thiáº¿t láº­p khÃ¡ rá»™ng, vÃ¬ cÃ¡i chuá»—i nhÃ©t vÃ o nÃ³ dÃ ii <em>wink wink</em>.</p>
<pre><code class="language-python"><div>figure = plot.figure(figsize=(<span class="hljs-number">20</span>,<span class="hljs-number">2</span>))
axes = plot.axes([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]);
plot.close()
</div></code></pre>
<p>OK giá» Ä‘áº¿n lÃºc váº½ cÃ¡i Ä‘á»“ thá»‹ vá» Ä‘á»™ báº£o toÃ n. nÃ³ Ä‘Æ¡n giáº£n chá»‰ lÃ  má»™t cÃ¡i bar graph cho tháº¥y Ä‘á»™ báº£o toÃ n á»Ÿ tá»«ng residue.</p>
<p>Reminder: Ä‘á»ƒ gá»i bargraph: <code>axes.bar(range,data,**args)</code>. Trong trÆ°á»ng há»£p nÃ y chÃºng ta cáº§n cÃ¡c parameters <code>align='edge', linewidth=0</code> Ä‘á»ƒ giÃ³ng hÃ ng cÃ¡c amino acid. <code>align='edge'</code> lÃ m cho cÃ¡c cá»™t giÃ³ng hÃ ng á»Ÿ cáº¡nh trÃ¡i, vÃ  <code>linewidth=0</code> lÃ m cho khoáº£ng cÃ¡ch cÃ¡c cá»™t khÃ­t hÆ¡n.</p>
<pre><code class="language-python"><div>axes.bar(range(<span class="hljs-number">0</span>,L),conservation, align=<span class="hljs-string">&#x27;edge&#x27;</span>, linewidth = <span class="hljs-number">0</span>, color = <span class="hljs-string">&#x27;red&#x27;</span>)
axes.set_ylabel(<span class="hljs-string">&#x27;Conservation&#x27;</span>)
</div></code></pre>
<p><img src="file:///d:\Project\Writing\lamdv.github.io\docs\Scientific Journey\Sequence%20visualization%20with%20matplotlib_files\Sequence%20visualization%20with%20matplotlib_21_0.svg" alt="svg"></p>
<p>Giá» Ä‘áº¿n lÃºc váº½ cÃ¡c chuá»—i. ChÃºng ta láº¥y ra 5 chuá»—i ngáº«u nhiÃªn tá»« MSA, Ä‘Æ¡n giáº£n vÃ¬ vá»›i 1000 chuá»—i thÃ¬ data cá»§a mÃ¬nh quÃ¡ rá»™ng Ä‘á»ƒ cÃ³ thá»ƒ váº½ táº¥t cáº£. Äá»“ng thá»i chÃºng ta tÃ­nh toÃ¡n khoáº£ng cÃ¡ch giá»¯a cÃ¡c chuá»—i, cÅ©ng nhÆ° khoáº£ng cÃ¡ch tá»« Ä‘Ã¡y Ä‘á»“ thá»‹ Ä‘áº¿n chuá»—i Ä‘áº§u tiÃªn.</p>
<p>Khoáº£ng cÃ¡ch giá»¯a cÃ¡c chuá»—i Ä‘Æ°á»£c tÃ­nh báº±ng cáº­n cá»§a trá»¥c y chia 6. Táº¡i sao? VÃ¬ chia 6 nÃ³ khá»›p hÃ ng ğŸ˜…, khÃ´ng cÃ³ giáº£i thÃ­ch nÃ o hay hÆ¡n cáº£ ...</p>
<pre><code class="language-python"><div>spacing_scale = axes.get_ylim()[<span class="hljs-number">1</span>]/<span class="hljs-number">6</span>
spacing = spacing_scale*<span class="hljs-number">2</span>

seq_display = np.sort(np.random.randint(<span class="hljs-number">0</span>,N,[<span class="hljs-number">5</span>]))
</div></code></pre>
<p>Ok, giá» thÃ¬ lÃ m sao mÃ  váº½?</p>
<p>Vá»›i má»—i chuá»—i, trÆ°á»›c tiÃªn ta tÃ­nh toÃ¡n khoáº£ng cÃ¡ch Ä‘áº¿n gá»‘c tá»a Ä‘á»™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>. Vá»‹ trÃ­ trá»¥c x cá»§a tá»«ng residue Ä‘Æ°á»£c tÃ­nh toÃ¡n Ä‘Æ¡n giáº£n lÃ  vá»‹ trÃ­ cá»§a chÃ­nh nÃ³ trong chuá»—i. KhÃ¡ gá»n. TiÃªu Ä‘á» cá»§a tá»«ng chuá»—i Ä‘Æ°á»£c váº½ dá»‹ch vá» bÃªn trÃ¡i báº±ng cÃ¡ch láº¥y giÃ¡ trá»‹ x Ã¢m, vÃ  trong trÆ°á»ng há»£p nÃ y ta láº¥y lÃ  -5.</p>
<p><code>axes.text()</code> Ä‘Æ°á»£c gá»i Ä‘á»ƒ váº½ tá»«ng residue. Vá»›i má»—i residue chÃºng ta cÃ³ má»™t cÃ¡i bbox váº½ Ä‘Ã¨ lÃªn. CÃ¡c bbox nÃ y cÃ³ <code>alpha=0.5</code> Ä‘á»ƒ nÃ³  trong suá»‘t, vÃ  mÃ u nhÆ° trong palette mÃ u Ä‘Ã£ Ä‘á»‹nh nghÄ©a á»Ÿ trÃªn.</p>
<p>Ã€ mÃ  nhá»› dÃ¹ng <code>fontdict=font</code> Ä‘á»ƒ xÃ i cÃ¡i font family nÃ£y nhÃ©.</p>
<pre><code class="language-python"><div><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> seq_display:
    posit = -float(np.where(seq_display == j)[<span class="hljs-number">0</span>]) * spacing_scale - spacing
    axes.text(<span class="hljs-number">-5</span>,posit, <span class="hljs-string">&quot;Seq &quot;</span>+(str(j+<span class="hljs-number">1</span>)))
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, L):
        axes.text(float(i),posit, msa[j].seq[i],
            bbox=dict(facecolor=palette[aa.find(msa[j].seq[i])], 
            alpha=<span class="hljs-number">0.5</span>),fontdict=font)
</div></code></pre>
<p><img src="file:///d:\Project\Writing\lamdv.github.io\docs\Scientific Journey\Sequence%20visualization%20with%20matplotlib_files\Sequence%20visualization%20with%20matplotlib_25_0.svg" alt="svg"></p>
<p>Cuá»‘i cÃ¹ng, chÃºng ta thÃªm chuá»—i Ä‘á»“ng thuáº­n:</p>
<pre><code class="language-python"><div>posit = posit - spacing
axes.text(<span class="hljs-number">-5</span>,posit, <span class="hljs-string">&quot;Concensus&quot;</span>)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, L):
    axes.text(float(i),posit, <span class="hljs-string">&#x27;ARNDCQEGHILKMFPSTWYV-&#x27;</span>[int(concensus[i])] ,
                bbox=dict(facecolor=palette[int(concensus[i])], 
                alpha=<span class="hljs-number">0.5</span>),fontdict=font)
</div></code></pre>
<p><img src="file:///d:\Project\Writing\lamdv.github.io\docs\Scientific Journey\Sequence%20visualization%20with%20matplotlib_files\Sequence%20visualization%20with%20matplotlib_27_0.svg" alt="svg"></p>
<p>Et voila! ÄÃ¢y lÃ  má»™t cÃ¡ch nhanh (vÃ  báº©n) Ä‘á»ƒ hiá»ƒn thá»‹ dataset. MÃ¬nh hi vá»ng nÃ³ Ä‘á»§ Ä‘Æ¡n giáº£n Ä‘á»ƒ cÃ¡c báº¡n cÃ³ thá»ƒ tá»± biá»ƒn Ä‘á»•i nÃ³ cho tá»«ng loáº¡i dá»¯ liá»‡u riÃªng (Genomics, transcriptomics...), vÃ  cÅ©ng nhÆ° dÃ¹ng cÃ¡c loáº¡i Ä‘á»“ thá»‹ khÃ¡c lÃ m ná»n táº£ng. Tuy nhiÃªn, phÆ°Æ¡ng phÃ¡p nÃ y cÃ³ láº½ khÃ´ng pháº£i lÃ  cÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ hiá»ƒn thá»‹ cÃ¡c chuá»—i dÃ i hÆ¡n - báº¡n pháº£i tá»± tÃ¬m Ä‘Æ°á»ng phÃ¹ há»£p nháº¥t vá»›i dá»¯ liá»‡u cá»§a mÃ¬nh. NhÆ°ng Ä‘Ã³ lÃ  Ä‘iá»u hay ho khi lÃ m Bioinfomatics!!! VÃ  giá» thÃ¬ báº¡n cÃ³ toÃ n quyá»n kiá»ƒm soÃ¡t trÃªn quÃ¡ trÃ¬nh rá»“i.</p>
<p>[^1]: Notebook Jupyter gá»‘c (tiáº¿ng Anh) thÃ¬ á»Ÿ <a href="https://github.com/lamdv/lamdv.github.io/blob/source/docs/Sequence%20visualization%20with%20matplotlib.ipynb">Ä‘Ã¢y</a></p>

    </body>
    </html>